<!DOCTYPE html>
<html>
<head>
  <title>Download Progress Example</title>
  <style>
    .progress-popup {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background-color: #ffffff;
      border: 1px solid #cccccc;
      padding: 20px;
      text-align: center;
      display: none;
    }

    .progress-popup .progress-bar {
      width: 200px;
      height: 20px;
      background-color: #f2f2f2;
      border: 1px solid #cccccc;
      margin-bottom: 10px;
    }
  </style>
  <script>
    function downloadFile() {
      var fileUrl = 'path/to/file.png';
      var fileName = 'myfile.png';

      // Create the progress element dynamically
      var progressElement = document.createElement('div');
      progressElement.classList.add('progress-popup');
      progressElement.innerHTML = `
        <div class="progress-bar"></div>
        <span class="progress-text">0%</span>
      `;

      // Append the progress element to the document body
      document.body.appendChild(progressElement);

      // Show the progress element
      progressElement.style.display = 'block';

      // Create a new XMLHttpRequest to track the download progress
      var xhr = new XMLHttpRequest();
      xhr.open('GET', fileUrl, true);
      xhr.responseType = 'blob';

      // Track the progress using the onprogress event
      xhr.onprogress = function(e) {
        if (e.lengthComputable) {
          var percent = Math.floor((e.loaded / e.total) * 100);
          var progressBar = progressElement.querySelector('.progress-bar');
          var progressText = progressElement.querySelector('.progress-text');
          progressBar.style.width = percent + '%';
          progressText.innerText = percent + '%';
        }
      };

      // When the download is complete
      xhr.onload = function() {
        if (xhr.status === 200) {
          // Create a temporary download link
          var downloadLink = document.createElement('a');
          var objectUrl = URL.createObjectURL(xhr.response);
          downloadLink.href = objectUrl;
          downloadLink.download = fileName;

          // Trigger the download
          downloadLink.click();

          // Remove the temporary download link
          URL.revokeObjectURL(objectUrl);

          // Remove the progress element from the document body
          document.body.removeChild(progressElement);
        }
      };

      // Start the download
      xhr.send();
    }
  </script>
</head>
<body>
  <button onclick="downloadFile()">Download File</button>
</body>
</html>
